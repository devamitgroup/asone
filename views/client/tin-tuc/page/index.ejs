<!DOCTYPE html>
<html lang="vi">
<%- include('../../partials/head', { title: title }) %>
<body>
    <%- include('../../partials/header') %>

    <div class="navi">
        <div class="w-ct padding15">
            <a href="/">Trang chủ</a><span>/</span>
            <span>Tin tức</span>
        </div>
    </div>

    <div class="w-ct clearfix lstproduct padding15">
        <div class="row" id="listproduct">
            <div class="col-xs-12 text-center">Đang tải tin tức...</div>
        </div>
    </div>

    <%- include('../../partials/footer') %>
    <%- include('../../partials/social_ring') %>
    <%- include('../../partials/scripts') %>

    <script>
        function convertToYYYYMMDD(dateString) {
            const date = new Date(dateString);
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            const formattedMonth = month < 10 ? `0${month}` : month;
            const formattedDay = day < 10 ? `0${day}` : day;
            return `${year}/${formattedMonth}/${formattedDay}`;
        }

        (async() =>{
            const listproduct = document.querySelector('#listproduct');
            try {
                const res = await fetch(`/tin-tuc/get-tin-tuc`);
                const data = await res.json();
                if(data && data.length > 0){
                    listproduct.innerHTML = '';
                    data.forEach(value => {
                        listproduct.innerHTML += `
                            <div class="col-md-3 col-sm-6 col-xs-12">
                                <div class="item">
                                    <div class="hn-i">
                                        <div class="hn-img">
                                            <span>${convertToYYYYMMDD(value.createdAt)}</span>
                                            <a href="/tin-tuc/${value.slug}" title="${value.name}">
                                                <img alt="${value.name}" src="${value.avt}" />
                                            </a>
                                        </div>
                                        <div class="hn-inf">
                                            <h3><a href="/tin-tuc/${value.slug}" title="${value.name}">${value.name}</a></h3>
                                            <p>${value.describe || ''}</p>
                                            <div><a href="/tin-tuc/${value.slug}">Xem thêm <i class="fa fa-arrow-right"></i></a></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                } else {
                    listproduct.innerHTML = '<div class="col-xs-12 text-center">Không có tin tức nào.</div>';
                }
            } catch (e) { console.error('News error:', e); }
        })()
    </script>
</body>
</html>
